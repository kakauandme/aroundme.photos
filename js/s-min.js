function GeocodingMarker(e){this.position=null,this.bounds=null,this.map=null;var t={clickable:!0,cursor:"pointer",icon:{path:geoIcon,fillColor:colors.purple,fillOpacity:1,scale:.7,strokeWeight:0,strokeColor:colors.purple,strokeOpacity:0,anchor:new google.maps.Point(64,128)},optimized:!0,position:new google.maps.LatLng(0,0),zIndex:2};this.marker_=new google.maps.Marker(t),e&&this.setMap(e)}function GeolocationMarker(e){var t={clickable:!0,cursor:"pointer",icon:{path:curIcon,fillColor:colors.red,fillOpacity:1,scale:.7,strokeWeight:0,strokeColor:colors.red,strokeOpacity:0,anchor:new google.maps.Point(64,64)},optimized:!0,position:new google.maps.LatLng(0,0),title:"My location",zIndex:2},o={clickable:!1,radius:0,strokeColor:colors.blue,strokeOpacity:1,fillColor:colors.green,fillOpacity:.4,strokeWeight:1,zIndex:1,visible:!1};this.marker_=new google.maps.Marker(t),this.circle_=new google.maps.Circle(o),this.accuracy=null,this.position=null,this.map=null,this.set("minimum_accuracy",null),this.set("position_options",{enableHighAccuracy:!0,maximumAge:1e3}),this.circle_.bindTo("map",this.marker_),e&&this.setMap(e)}function PhotoOverlay(e,t){this._map=t||null,this._position=new google.maps.LatLng(e.location.latitude,e.location.longitude),this._photo=e,this._marker=null,this._img=null,this._zoomed=!1,t&&this.setMap(t)}function preg_quote(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}function highlight(e,t){return e.replace(new RegExp("("+preg_quote(t)+")","gi"),"<strong>$1</strong>")}function resetInput(){search.className="",selected_segesstion=-1,search_suggestions.innerHTML="",s_submit.title="Search",setTimeout(function(){s_input.value=""},600)}function processSugesstions(e,t){if(s_suggestions.innerHTML="",t===google.maps.places.PlacesServiceStatus.OK)for(var o=0,n;n=e[o],3>o;o++){var s=document.createElement("p");s.innerHTML=highlight(n.description,s_input.value),s.setAttribute("data-id",n.place_id),s.setAttribute("data-description",n.description),s.addEventListener("click",function(e){return function(){selected_segesstion=e,displaySuggestion()}}(o)),s_suggestions.appendChild(s)}}function getSuggestions(){clearTimeout(input_timer),input_timer=setTimeout(function(){0===s_input.value.length?(s_suggestions.innerHTML="",selected_segesstion=-1,search.className="open empty",s_submit.title="Close"):(search.className="open",s_submit.title="Search",autocomplete.getPlacePredictions({input:s_input.value,types:["(cities)"]},processSugesstions))},300)}function selectSugestion(){for(var e=s_suggestions.childNodes.length-1;e>=0;e--)e!==selected_segesstion?s_suggestions.childNodes[e].className="":s_suggestions.childNodes[selected_segesstion].className="selected";s_input.value=s_suggestions.childNodes[selected_segesstion].getAttribute("data-description")}function displaySuggestion(){if(0===search.className.length)search.className="open empty",selected_segesstion=-1,s_submit.title="Close",s_input.focus();else if(0===s_input.value.length)resetInput();else if(0!==s_suggestions.childNodes.length){0>selected_segesstion&&(selected_segesstion=0),selectSugestion();var e=new google.maps.places.PlacesService(map);e.getDetails({placeId:s_suggestions.childNodes[selected_segesstion].getAttribute("data-id")},function(e,t){if(t===google.maps.places.PlacesServiceStatus.OK){cityMarker.updatePosition_(e),document.title=e.name+" | Around me photos",title.textContent="Photos of "+e.name,subtitle.textContent="Explore social activity in "+e.name+" area";for(var o="",n=e.address_components.length-1;n>=0;n--)if("country"===e.address_components[n].types[0]){o="/"+e.address_components[n].long_name.toLowerCase().replace(" ","-");break}o+="/"+e.name.toLowerCase().replace(" ","-"),history.replaceState({},document.title,o),resetInput()}else search.className="open noresults",setTimeout(function(){search.className="open"},600)})}else search.className="open noresults",setTimeout(function(){search.className="open"},600)}function increment(){1===++loadingCount&&(ham.title="Loading ...",ham.className="loading")}function decrement(){0===--loadingCount&&(ham.title="Info",ham.className="")}function calcMapRadius(){center=map.getCenter(),bounds=map.getBounds();var e=bounds.getNorthEast(),t=new google.maps.LatLng(e.lat(),center.lng()),o=new google.maps.LatLng(center.lat(),e.lng()),n=getDistance(center,t),s=getDistance(center,o);radius=s>n?n:s,curPosMarker.circle_.setVisible(curPosMarker.circle_.getRadius()>radius/3),map.setOptions(radius>=5e3?{minZoom:map.getZoom()}:{minZoom:null})}function getImagesFromInstagram(){var e=instagramUrl;e+="&lat="+center.lat(),e+="&lng="+center.lng(),e+="&distance="+radius;var t=document.createElement("script");t.type="text/javascript",t.src=e,document.body.appendChild(t)}function processInstagramImages(e){if(200===e.meta.code&&e.data.length>0)for(var t=0;t<e.data.length;t++)if("image"===e.data[t].type){"undefined"==typeof localStorage[e.data[t].id]&&markers.push(new PhotoOverlay(e.data[t],map));try{localStorage[e.data[t].id]=JSON.stringify(e.data[t])}catch(o){}}}function getImagesFromLocalStorage(){var e=new Date,t,o,n=0;for(var s in localStorage)if("lat"!==s&&"lng"!==s&&"length"!==s)if(o=JSON.parse(localStorage[s]),t=new Date(1e3*parseInt(o.created_time)),Math.ceil((e-t)/864e5)>1)localStorage.removeItem(s);else if(markers.push(new PhotoOverlay(o)),++n>999)break}function processLocalImages(){for(var e=!1,t=0,o=0;o<markers.length;o++)if(e=bounds.contains(markers[o].getPosition())){if(++t>99)break;null===markers[o].getMap()&&markers[o].updateMap(map)}else null!==markers[o].getMap()&&markers[o].updateMap(null)}function initialize(){center=new google.maps.LatLng(curentPosition.lat,curentPosition.lng);var e={center:center,zoom:geocoding?14:16,disableDefaultUI:!0,disableDoubleClickZoom:!0,styles:stylers,backgroundColor:"#FFEEC6"};if(map=new google.maps.Map(document.getElementById("map"),e),cityMarker=new GeocodingMarker(map),google.maps.event.addListener(cityMarker,"position_changed",function(){center=this.getPosition(),map.setCenter(center);var e=this.getBounds(),t=e.getNorthEast(),o=e.getSouthWest(),n=getDistance(t,o);5e3>n/2&&map.fitBounds(e)}),google.maps.event.addListener(cityMarker.getPin(),"click",function(){map.panTo(cityMarker.getPosition())}),geocoding){var t=city;"undefined"!=typeof country&&0!==country.length&&(t+=", "+country);var o=new google.maps.Geocoder;o.geocode({address:t},function(e,t){t===google.maps.GeocoderStatus.OK?cityMarker.updatePosition_(e[0]):window.location.href="/404.php"})}curPosMarker=new GeolocationMarker(map),google.maps.event.addListener(curPosMarker.getPin(),"click",function(){map.panTo(curPosMarker.getPosition())}),google.maps.event.addListenerOnce(curPosMarker,"position_changed",function(){geocoding||(center=this.getPosition(),map.panTo(center)),localStorage.lat=this.getPosition().lat(),localStorage.lng=this.getPosition().lng()}),google.maps.event.addListenerOnce(curPosMarker,"geolocation_error",function(e){curPosMarker.getPosition()||geocoding||alert("There was an error obtaining your position. Please make sure that geolocation is enabled.")});var n=document.createElement("div");n.index=1;var s=document.createElement("div");s.className="cur-position-control",s.title="Pan to my location",n.appendChild(s),map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(n),google.maps.event.addDomListener(s,"click",function(){map.panTo(curPosMarker.getPosition())}),getImagesFromLocalStorage(),autocomplete=new google.maps.places.AutocompleteService,google.maps.event.addListener(map,"dragstart",function(){increment()}),google.maps.event.addListener(map,"dragend",function(){decrement()}),google.maps.event.addListenerOnce(map,"tilesloaded",function(){clearInterval(timer),timer=0,body.className="ready",setTimeout(function(){body.className+=" complete"},1200)}),google.maps.event.addListener(map,"idle",function(){increment(),setTimeout(decrement,1e3)}),google.maps.event.addListener(map,"tilesloaded",function(){increment(),0===radius?calcMapRadius():(center=map.getCenter(),bounds=map.getBounds()),getImagesFromInstagram(),processLocalImages(),setTimeout(decrement,1e3)}),google.maps.event.addListener(map,"zoom_changed",function(){increment(),setTimeout(decrement,1e3),calcMapRadius()}),google.maps.event.addListener(map,"resize",function(){increment(),setTimeout(decrement,1e3),radius=0}),window.onresize=function(){google.maps.event.trigger(map,"resize")}}function loadResources(){initialize();var e=document.createElement("link");e.href="/css/footer.css",e.rel="stylesheet",e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),function(e,t,o,n,s,a,i){e.GoogleAnalyticsObject=s,e[s]=e[s]||function(){(e[s].q=e[s].q||[]).push(arguments)},e[s].l=1*new Date,a=t.createElement(o),i=t.getElementsByTagName(o)[0],a.async=1,a.src=n,i.parentNode.insertBefore(a,i)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-40067737-9","aroundme.photos"),ga("require","displayfeatures"),ga("send","pageview")}GeocodingMarker.prototype=new google.maps.MVCObject,GeocodingMarker.prototype.set=function(e,t){if(/^(?:position|accuracy)$/i.test(e))throw"'"+e+"' is a read-only property.";/map/i.test(e)?this.setMap(t):google.maps.MVCObject.prototype.set.apply(this,arguments)},GeocodingMarker.prototype.marker_=null,GeocodingMarker.prototype.getPin=function(){return this.marker_},GeocodingMarker.prototype.getMap=function(){return this.map},GeocodingMarker.prototype.getPosition=function(){return this.position},GeocodingMarker.prototype.getBounds=function(){return this.bounds},GeocodingMarker.prototype.setMap=function(e){this.map=e,this.notify("map"),e||(this.marker_.unbind("position"),this.position=null,this.bounds=null,google.maps.event.clearInstanceListeners(this.marker_),this.marker_.setMap(e))},GeolocationMarker.prototype.setMarkerOptions=function(e){this.marker_.setOptions(this.copyOptions_({},e))},GeocodingMarker.prototype.updatePosition_=function(e){var t=e.geometry.location,o=null==this.marker_.getMap();o&&(this.marker_.setMap(this.map),this.marker_.bindTo("position",this)),(o||null==this.position||!this.position.equals(t))&&(this.bounds=e.geometry.viewport,this.marker_.setTitle(e.formatted_address),google.maps.MVCObject.prototype.set.call(this,"position",t))},GeolocationMarker.prototype.copyOptions_=function(e,t){for(var o in t)GeolocationMarker.DISALLOWED_OPTIONS[o]!==!0&&(e[o]=t[o]);return e},GeolocationMarker.DISALLOWED_OPTIONS={map:!0,position:!0,radius:!0},GeolocationMarker.prototype=new google.maps.MVCObject,GeolocationMarker.prototype.set=function(e,t){if(/^(?:position|accuracy)$/i.test(e))throw"'"+e+"' is a read-only property.";/map/i.test(e)?this.setMap(t):google.maps.MVCObject.prototype.set.apply(this,arguments)},GeolocationMarker.prototype.marker_=null,GeolocationMarker.prototype.getPin=function(){return this.marker_},GeolocationMarker.prototype.circle_=null,GeolocationMarker.prototype.getMap=function(){return this.map},GeolocationMarker.prototype.getPositionOptions=function(){return this.get("position_options")},GeolocationMarker.prototype.setPositionOptions=function(e){this.set("position_options",e)},GeolocationMarker.prototype.getPosition=function(){return this.position},GeolocationMarker.prototype.getBounds=function(){return this.position?this.circle_.getBounds():null},GeolocationMarker.prototype.getAccuracy=function(){return this.accuracy},GeolocationMarker.prototype.getMinimumAccuracy=function(){return this.get("minimum_accuracy")},GeolocationMarker.prototype.setMinimumAccuracy=function(e){this.set("minimum_accuracy",e)},GeolocationMarker.prototype.watchId_=-1,GeolocationMarker.prototype.setMap=function(e){this.map=e,this.notify("map"),e?this.watchPosition_():(this.marker_.unbind("position"),this.circle_.unbind("center"),this.circle_.unbind("radius"),this.accuracy=null,this.position=null,navigator.geolocation.clearWatch(this.watchId_),google.maps.event.clearInstanceListeners(this.marker_),this.watchId_=-1,this.marker_.setMap(e))},GeolocationMarker.prototype.setMarkerOptions=function(e){this.marker_.setOptions(this.copyOptions_({},e))},GeolocationMarker.prototype.setCircleOptions=function(e){this.circle_.setOptions(this.copyOptions_({},e))},GeolocationMarker.prototype.updatePosition_=function(e){var t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),o=null==this.marker_.getMap();if(o){if(null!=this.getMinimumAccuracy()&&e.coords.accuracy>this.getMinimumAccuracy())return;this.marker_.setMap(this.map),this.marker_.bindTo("position",this),this.circle_.bindTo("center",this,"position"),this.circle_.bindTo("radius",this,"accuracy")}this.accuracy!=e.coords.accuracy&&(google.maps.MVCObject.prototype.set.call(this,"accuracy",e.coords.accuracy),this.circle_.setVisible(e.coords.accuracy>radius/3)),(o||null==this.position||!this.position.equals(t))&&google.maps.MVCObject.prototype.set.call(this,"position",t)},GeolocationMarker.prototype.watchPosition_=function(){var e=this;navigator.geolocation&&(this.watchId_=navigator.geolocation.watchPosition(function(t){e.updatePosition_(t)},function(t){google.maps.event.trigger(e,"geolocation_error",t)},this.getPositionOptions()))},GeolocationMarker.prototype.copyOptions_=function(e,t){for(var o in t)GeolocationMarker.DISALLOWED_OPTIONS[o]!==!0&&(e[o]=t[o]);return e},GeolocationMarker.DISALLOWED_OPTIONS={map:!0,position:!0,radius:!0},PhotoOverlay.prototype=new google.maps.OverlayView,PhotoOverlay.prototype.onAdd=function(){increment();var e=this,t=this._photo,o=document.createElement("div");o.id="marker-"+t.id,o.setAttribute("data-id",t.id),o.className="marker";var n=new Image;n.onload=function(){e._zoomed||(o.className+=" loaded flyin",setTimeout(function(){o.className=o.className.replace(regflyin,""),google.maps.event.addDomListener(o,"click",function(e){return function(t){return t.stopPropagation(),e.zoom(),!1}}(e))},1500),decrement())},n.onerror=function(){localStorage.removeItem(t.id),e._zoomed?n.src=t.images.thumbnail.url:decrement()},n.width=150,n.height=150,n.src=t.images.thumbnail.url,o.appendChild(n),this._marker=o,this._img=n;var s=this.getPanes();s.overlayMouseTarget.appendChild(o)},PhotoOverlay.prototype.getPosition=function(){return this._position},PhotoOverlay.prototype.getLikes=function(){return parseInt(this._photo.likes.count)},PhotoOverlay.prototype.getMap=function(){return this._map},PhotoOverlay.prototype.updateMap=function(e){this._map=e,this.setMap(e)},PhotoOverlay.prototype.onRemove=function(){this===curMarker&&(curMarker=null),google.maps.event.clearInstanceListeners(this._marker),this._marker.parentNode.removeChild(this._marker),this._marker=null,this._img=null,this._zoomed=!1,this._map=null},PhotoOverlay.prototype.draw=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this._position),o=this._marker;o.style.left=t.x+-o.offsetWidth/2+"px",o.style.top=t.y+-o.offsetHeight/2+"px"},PhotoOverlay.prototype.zoom=function(){if(null!==curMarker){var e=curMarker._marker;e.className="marker loaded zoom",e.getElementsByTagName("span")[0].className="info",e.getElementsByTagName("span")[0].title="Info",setTimeout(function(){e.className="marker loaded"},300)}if(curMarker!==this){var t=this._marker;if(t.className+=" zoom zoomed",!this._zoomed){this._zoomed=!0,this._img.src=this._photo.images.standard_resolution.url;var o=document.createElement("div");o.className="overlay";var n=document.createElement("p");n.textContent=this._photo.likes.count,n.className="likes";var s=document.createElement("hr"),a=document.createElement("p");a.className="author",a.textContent="by ";var i=document.createElement("a");i.href=iOS?"instagram://user?username="+this._photo.user.username:"http://instagram.com/"+this._photo.user.username,i.title=0===this._photo.user.full_name.length?this._photo.user.username:this._photo.user.full_name,i.target="_blank",i.textContent=this._photo.user.username,i.onclick=function(e){e.stopPropagation()};var r=document.createElement("span");r.title="Info",r.className="info",r.onclick=function(e){e.stopPropagation(),4===this.className.length?(this.title="Hide info",this.className+=" close",this.parentNode.parentNode.className+=" detailed"):(this.title="Info",this.className="info",this.parentNode.parentNode.className=this.parentNode.parentNode.className.replace(regdetailed,""))},this._marker.appendChild(o),o.appendChild(n),o.appendChild(s),o.appendChild(a),a.appendChild(i),o.appendChild(r)}curMarker=this}else curMarker=null};var search=document.getElementById("search"),form=document.getElementById("search_form"),s_submit=document.getElementById("s_submit"),s_input=document.getElementById("s_input"),s_suggestions=document.getElementById("search_suggestions"),input_timer=0,selected_segesstion=-1,title=document.getElementById("title"),subtitle=document.getElementById("subtitle");form.addEventListener("submit",function(e){e.preventDefault(),displaySuggestion()}),s_input.addEventListener("keypress",function(e){13!==e.keyCode&&getSuggestions()}),s_input.onkeydown=function(e){8===e.keyCode?getSuggestions():27===e.keyCode?(e.preventDefault(),resetInput()):0!==s_suggestions.childNodes.length&&(38===e.keyCode||40===e.keyCode||9===e.keyCode)&&(38===e.keyCode?--selected_segesstion<0&&(selected_segesstion=s_suggestions.childNodes.length-1):++selected_segesstion>=s_suggestions.childNodes.length&&(selected_segesstion=0),selectSugestion(),e.preventDefault())};var APP_KEY="4a37870c5f594c2c9c563a80fae04772",instagramUrl="https://api.instagram.com/v1/media/search?callback=processInstagramImages&client_id="+APP_KEY,curIcon="M44.3,38.1c-24.2,0-43.8,20-43.8,44.7s19.7,44.8,43.8,44.8s43.8-20.1,43.8-44.8S68.5,38.1,44.3,38.1z M47.9,114.9l-6.5-27.6l-26.8-6.9l53-19.9L47.9,114.9z M74.3,0.5c13.6,0,27.2,5.3,37.6,15.9s15.6,24.5,15.6,38.4h-11.7c0-10.9-4-21.7-12.2-29.9S84.9,12.5,74.2,12.5L74.3,0.5L74.3,0.5z M74.3,35c4.9,0,10,1.9,13.7,5.8c3.8,3.8,5.7,9,5.7,14H106c1.4-11.7-2.6-17.8-9.3-22.9c-6.2-6.3-14.3-9.5-22.5-9.5V35L74.3,35z",geoIcon="M37,49.5l46.9-17.2L66.5,79.4l-5.7-24L37,49.5z M115.1,52.6c0,28.7-24.8,47.6-51.1,73.8c-26.2-26.3-51.1-45.2-51.1-73.8C12.9,24.4,35.8,1.5,64,1.5S115.1,24.4,115.1,52.6z M101.5,51.1c0-20.7-16.8-37.5-37.5-37.5c-20.7,0-37.5,16.8-37.5,37.5c0,20.7,16.8,37.5,37.5,37.5C84.7,88.5,101.5,71.8,101.5,51.1z",colors={red:"#f74552","dark-purple":"#4f007d",purple:"#7329b0",blue:"#1a75cf",green:"#66d43d",yellow:"#fff5a1",black:"#24292e",grey:"#414b56","light-grey":"#8c8f91"},regnav=new RegExp("(\\s|^)nav(\\s|$)"),regflyin=new RegExp("(\\s|^)flyin(\\s|$)"),regdetailed=new RegExp("(\\s|^)detailed(\\s|$)"),iOS=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),rad=function(e){return e*Math.PI/180},getDistance=function(e,t){var o=6378137,n=rad(t.lat()-e.lat()),s=rad(t.lng()-e.lng()),a=Math.sin(n/2)*Math.sin(n/2)+Math.cos(rad(e.lat()))*Math.cos(rad(t.lat()))*Math.sin(s/2)*Math.sin(s/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),r=o*i;return r},radius=0,ham=document.getElementById("hamburger"),mSeconds=0,timerHolder=document.getElementById("timer").firstChild,timer=setInterval(function(){mSeconds+=100;var e=mSeconds/1e3;timerHolder.textContent=e.toFixed(1)+" sec"},100),curentPosition={lat:-37.803501,lng:144.977001};curentPosition.lat=parseFloat(localStorage.lat)||curentPosition.lat,curentPosition.lng=parseFloat(localStorage.lng)||curentPosition.lng;var map,curPosMarker,cityMarker,autocomplete,markers=[],curMarker=null,bounds,center,loadingCount=0;window.navigator.standalone&&(document.getElementById("c").style.paddingTop="10px");var stylers=[{stylers:[{saturation:100},{visibility:"simplified"}]},{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape.natural.terrain",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:colors.blue}]},{featureType:"administrative.locality",elementType:"labels.text",stylers:[{visibility:"on"}]}];if(ham.addEventListener("click",function(){0===ham.className.length&&(regnav.test(body.className)?(body.className=body.className.replace(regnav,""),ham.title="Info"):(body.className+=" nav",ham.title="Close"))}),navigator.geolocation&&"undefined"!=typeof Storage&&-1===navigator.userAgent.indexOf("Opera")||modernBrowser)google.maps.event.addDomListenerOnce(window,"load",loadResources);else{var str='<p>Yоu аrе usіng аn <strong>оutdаtеd</strong> brоwsеr. <br>Рlеаsе <a href="http://www.google.com/chrome/browser/" target="_blank">uрgrаdе yоur brоwsеr</a> tо usе thіs wеbsіtе.</p>';document.getElementById("browserhappy").innerHTML=str,body.className="ie",clearInterval(timer),timer=0,timerHolder.textContent=""}